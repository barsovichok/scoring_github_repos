<h1>Cкрипт оценки репозиториев Github</h1>

<h3>Требования:</h3>

* Версия Python - от 3.6.x


<h3>Что делает cкрипт:</h3>

Скрипт принимает на вход ссылку на открытый репозиторий пользователя Github и выставляет ему оценку по следующим критериям:

* Количество звёзд (0 звёзд – 0 баллов, 1-50 – 1 балл, >50 – 2 балла).
* Количество контрибьюторов (1 – 0 баллов, 2-10 – 1 балл, > 10 – 2 балла).
* Наличие лицензии (1 балл, если есть).
* Наличие ридми (1 балл, если есть).
* Наличие смердженных пул-реквестов за последние 30 дней (1, если есть).
* Наличие интеграции с Travis CI (1, если есть).
* Наличие форков (1, если есть).
* Наличие .editorconfig (1, если есть).

По результатам оценки скрипт выдает итоговое количество баллов, которое набрал репозиторий. 

<h4>Важно:</h4>

>Cкрипт использует client_id и 



, которые необходимы для отправки запросов к api Github. Чтобы получить эти переменные, вам нужно создать OAuth App на Github'e. Как это сделать, изложено [здесь](https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/). После создания приложения вам нужно будет перейти в свой профиль -> settings -> developer settings -> Oauth Apps и выбрать созданное приложение. В приложении будут указаны client_id и client_secret. Сохраните их где-нибудь, они нам скоро пригодятся.

>На данный момент есть два способа использования скрипта - запуск напрямую из командной строки или запуск сервера, который будет выдавать данные в json-формате в браузере.

><b>Добавлено хранение в Redis - теперь запрошенные ранее репозитории хранятся в базе, и скрипт отрабатывает быстрее :)</b>


<p>
   
<p/>


<h3>Запуск скрипта из командной строки</h3>


1. Скачайте репозиторий к себе локально
2. В командной строке перейдите в директорию, где сохранён репозиторий
3. Запустите файл <b>scoring_repos.py</b> с использованием переменных

<h4>Linux, Mac OS:</h4>

<p>Здесь переменные можно передать прямо при запуске приложения</p>

```
$ client_id = your_client_id, client_secret = your_client_secret  python script.py
```

<h4>Windows:</h4>

<p>В Windows мы сначала устанавливаем переменные среды командой SET, затем запускаем скрипт</p>

```
> SET client_id = your_client_id
> SET client_secret = your_client_secret 
> python scoring_repos.py 
```
4. В консоли появится предложение ввести название репозитория в формате аккаунт/название репозитория

```
>python scoring_repos.py
Укажите репозиторий в формате owner/repo
devmanorg/fiasko_bro # пример ввода репозитория
```
5. На выходе cкрипт выдает оценку в таком формате.
```
>python scoring_repos.py
Укажите репозиторий в формате owner/repo
devmanorg/fiasko_bro
Оценка репо: 8
```

<p>
   
<p/>

<h3>Запуск flask-приложения</h3>

>Добавлена авторизация. Теперь, перед тем, как запустить приложение, вам нужно будет будет написать на <b>почту taya.kulagina@gmail.com с темой "Хочу токен"</b>. В ответ я пришлю вам токен, который нужно будет использовать при формировании запроса (см. ниже) 

1. Скачайте репозиторий к себе локально
2. В командной строке перейдите в директорию, где сохранён репозиторий
3. Запустите файл <b>server.py</b> с использованием переменных

<h4>Linux, Mac OS:</h4>

<p>Здесь переменные можно передать прямо при запуске приложения</p>

```
$ client_id = your_client_id, client_secret = your_client_secret  python scoring_repos.py
```

<h4>Windows:</h4>

<p>В Windows мы сначала устанавливаем переменные среды командой SET, затем запускаем скрипт</p>

```
> SET client_id = your_client_id
> client_secret = your_client_secret 
> python server.py 
```

4. В консоли отобразится запуск сервера:

Обратите внимание, что сервер запускается в режиме Debug.
```
 * Serving Flask app "server" (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 316-930-196
 * Running on http://0.0.0.0:80/ (Press CTRL+C to quit)
```

5. После того, как вы получили сообщение, похожее на сообщение выше в командной строке, перейдите в браузере на страничку /evaluate_repo?owner=&namerepo=&token=, передав в owner имя пользователя Github'a, в namerepo - название репозитория, которые вы собираетесь оценивать, token - присланный вам по почте токен.

Пример запроса:
```
http://127.1.0.0/evaluate_repo?owner=devmanorg&namerepo=fiasko_bro&token=752d8800-e7ba-4c2b
```

Ответ возвращается в формате json
```
{
  "rate": 8
}
```

<h4>Некорректный запрос</h4>

В случае, если вы ввели некорректные данные репозитория, в браузере возвращается такой ответ:

Пример некорректного запроса:
```
http://127.0.0.1/evaluate_repo?owner=devmanjhorg&namerepo=fiasko_bro&token=752d8800-e7ba-4c2b
```
Пример ответа:
```
{
  "error": "Invalid values, please try again"
}
```
<h4>Запрос без авторизации</h4>

В случае, если вы ввели невалидный токен или отправили запрос без параметра token, в браузере возвращается такой ответ:

Пример некорректного запроса:
```
http://127.0.0.1/evaluate_repo?owner=devmanjhorg&namerepo=fiasko_bro
```

Пример ответа:
```
{
  "error": "You aren't authorized, pls email taya.kulagina@gmail.com"
}
```


Спасибо [@Melevir](https://github.com/Melevir) за помощь в этом нелегком деле :)

Если у вас остались какие-то вопросы, можете писать мне [сюда](https://t.me/TanyaKulagina) :)
